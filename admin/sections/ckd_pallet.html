<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CKD PALLET 관리</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
  <script src="../config/config.js"></script>
</head>
<body class="bg-gray-100 min-h-screen p-6">
  <div class="w-full mx-auto bg-white shadow-xl rounded-xl p-6">
    <h1 class="text-2xl font-bold mb-6">📦 CKD PALLET 관리</h1>
    
    <!-- 재고 현황 -->
    <div class="mb-6 p-4 bg-blue-50 rounded-lg border border-blue-200">
      <h2 class="text-lg font-semibold mb-2">현재 재고</h2>
      <div id="stockInfo" class="text-2xl font-bold text-blue-600">
        <span class="text-gray-500">로딩 중...</span>
      </div>
    </div>

    <!-- 탭 메뉴 -->
    <div class="mb-6 border-b">
      <div class="flex space-x-4">
        <button id="tabReceiving" class="px-4 py-2 font-semibold text-blue-600 border-b-2 border-blue-600">입고</button>
        <button id="tabShipping" class="px-4 py-2 font-semibold text-gray-500 hover:text-gray-700">출고</button>
        <button id="tabHistory" class="px-4 py-2 font-semibold text-gray-500 hover:text-gray-700">입출고 이력</button>
      </div>
    </div>

    <!-- 입고 섹션 -->
    <div id="receivingSection" class="section-content">
      <h2 class="text-xl font-semibold mb-4">입고 등록</h2>
      <div class="bg-gray-50 p-6 rounded-lg border">
        <div class="grid grid-cols-2 gap-4 mb-4">
          <div>
            <label class="block mb-1 font-medium">입고일</label>
            <input type="date" id="receiveDateInput" class="w-full border rounded px-3 py-2" />
          </div>
          <div>
            <label class="block mb-1 font-medium">트레일러 번호</label>
            <input type="text" id="containerNoInput" class="w-full border rounded px-3 py-2 bg-gray-100" placeholder="자동 부여" disabled />
            <p class="text-xs text-gray-500 mt-1">트레일러 번호는 자동으로 부여됩니다.</p>
          </div>
          <div>
            <label class="block mb-1 font-medium">입고처</label>
            <input type="text" id="receivingPlaceInput" class="w-full border rounded px-3 py-2 bg-gray-100" value="PTA" disabled />
            <p class="text-xs text-gray-500 mt-1">입고처는 항상 PTA입니다.</p>
          </div>
          <div>
            <label class="block mb-1 font-medium">수량</label>
            <input type="number" id="quantityInput" class="w-full border rounded px-3 py-2" placeholder="예: 100" min="1" />
          </div>
        </div>
        <div class="mb-4">
          <label class="block mb-1 font-medium">비고</label>
          <input type="text" id="remarkInput" class="w-full border rounded px-3 py-2" placeholder="선택사항" />
        </div>
        <button id="submitReceivingBtn" class="bg-green-600 text-white px-6 py-2 rounded hover:bg-green-700">
          입고 등록
        </button>
      </div>
    </div>

    <!-- 출고 섹션 -->
    <div id="shippingSection" class="section-content hidden">
      <h2 class="text-xl font-semibold mb-4">출고 등록</h2>
      <div class="bg-gray-50 p-6 rounded-lg border">
        <div class="grid grid-cols-2 gap-4 mb-4">
          <div>
            <label class="block mb-1 font-medium">출고일</label>
            <input type="date" id="shippingDateInput" class="w-full border rounded px-3 py-2" />
          </div>
          <div>
            <label class="block mb-1 font-medium">출고 수량</label>
            <input type="number" id="shippingQuantityInput" class="w-full border rounded px-3 py-2" placeholder="예: 30" min="1" />
          </div>
        </div>
        <div class="mb-4">
          <label class="block mb-1 font-medium">비고</label>
          <input type="text" id="shippingRemarkInput" class="w-full border rounded px-3 py-2" placeholder="선택사항" />
        </div>
        <div class="mb-4 p-3 bg-yellow-50 border border-yellow-200 rounded">
          <p class="text-sm text-yellow-800">
            ⚠️ 출고 지시서가 생성되며, 출고증이 자동으로 출력됩니다.<br>
            출하 확정 페이지에서 확정하면 재고에서 차감됩니다. (FIFO 방식: 오래된 입고부터 차감)
          </p>
        </div>
        <button id="submitShippingBtn" class="bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-700">
          출고 등록
        </button>
      </div>
    </div>

    <!-- 입출고 이력 섹션 -->
    <div id="historySection" class="section-content hidden">
      <h2 class="text-xl font-semibold mb-4">입출고 이력</h2>
      <div class="mb-4">
        <div class="flex gap-4">
          <div>
            <label class="block mb-1 font-medium">시작일</label>
            <input type="date" id="historyStartDate" class="border rounded px-3 py-2" />
          </div>
          <div>
            <label class="block mb-1 font-medium">종료일</label>
            <input type="date" id="historyEndDate" class="border rounded px-3 py-2" />
          </div>
          <div class="flex items-end">
            <button id="searchHistoryBtn" class="bg-gray-600 text-white px-4 py-2 rounded hover:bg-gray-700">
              조회
            </button>
          </div>
        </div>
      </div>
      <div class="overflow-x-auto">
        <table class="min-w-full border">
          <thead class="bg-gray-100">
            <tr>
              <th class="border px-4 py-2">일자</th>
              <th class="border px-4 py-2">구분</th>
              <th class="border px-4 py-2">컨테이너/트레일러</th>
              <th class="border px-4 py-2">수량</th>
              <th class="border px-4 py-2">입고처</th>
              <th class="border px-4 py-2">비고</th>
            </tr>
          </thead>
          <tbody id="historyTableBody">
            <tr>
              <td colspan="6" class="border px-4 py-4 text-center text-gray-500">
                날짜를 선택하고 조회 버튼을 클릭하세요.
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- 메시지 모달 -->
  <div id="messageModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden z-50 flex items-center justify-center">
    <div class="bg-white rounded-lg p-6 max-w-md w-full mx-4">
      <h3 id="messageTitle" class="text-lg font-semibold mb-4">알림</h3>
      <p id="messageContent" class="text-gray-700 mb-4"></p>
      <button id="messageConfirmBtn" class="w-full bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">
        확인
      </button>
    </div>
  </div>

  <script src="../js/ckd_pallet.js" type="module"></script>
</body>
</html>
