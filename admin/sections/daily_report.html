<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ì¼ì¼ ì…ì¶œê³  í˜„í™© ë¦¬í¬íŠ¸</title>
  <script src="https://cdn.jsdelivr.net/npm/exceljs/dist/exceljs.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
  <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
  <script src="../config/config.js"></script>
  <script>
    // config.jsì—ì„œ SUPABASE_URL, SUPABASE_KEYë¥¼ ë°›ì•„ì„œ supabase ì´ˆê¸°í™”
    const supabase = window.supabase.createClient(window.SUPABASE_URL, window.SUPABASE_KEY);
  </script>
  <style>
    body { font-family: 'Malgun Gothic', 'ë§‘ì€ ê³ ë”•', Arial, sans-serif; }
    .container {
      margin: 40px auto;
      max-width: 2400px;
      width: 100%;
    }
    label, input, button { font-size: 1.5em; }
    button { background: #1e40af; color: #fff; border: none; padding: 8px 20px; border-radius: 4px; cursor: pointer; }
    button:hover { background: #1e3a8a; }
    .print-btn { background: #0e7490; margin-left: 10px; }
    .print-btn:hover { background: #155e75; }
    .print-table-wrapper {
      margin-top: 30px;
      width: 100%;
      max-width: 100%;
    }
    th { background: #1e40af !important; color: #fff !important; }
    /* í™•ì¸, ì‹œê°„, ë©”ëª¨ ì»¬ëŸ¼ 2ë°° ë„“íˆê¸° */
    td:nth-child(8), th:nth-child(8),
    td:nth-child(9), th:nth-child(9),
    td:nth-child(10), th:nth-child(10) {
      min-width: 200px;
      width: 200px;
    }
    /* ì»¨í…Œì´ë„ˆ ë²ˆí˜¸ ì»¬ëŸ¼ ë” ë„“ê²Œ */
    td:nth-child(4), th:nth-child(4) {
      min-width: 200px;
      width: 200px;
    }
    .print-table-wrapper table {
      width: 100%;
      table-layout: fixed;
    }
    .print-table-wrapper th, .print-table-wrapper td {
      white-space: normal;
      word-break: break-all;
      height: 48px;
      line-height: 1.4;
      vertical-align: middle;
    }
    /* ìš”ì•½ ëŒ€ì‹œë³´ë“œ ìŠ¤íƒ€ì¼ */
    .summary-dashboard {
      background: white;
      border-radius: 8px;
      padding: 30px;
      margin: 30px 0;
      box-shadow: 0 2px 8px rgba(0,0,0,0.08);
    }
    .summary-title {
      text-align: center;
      font-size: 2em;
      font-weight: bold;
      margin-bottom: 10px;
      color: #1e293b;
    }
    .summary-date {
      text-align: center;
      font-size: 1.3em;
      color: #475569;
      margin-bottom: 30px;
    }
    .summary-cards {
      display: flex;
      justify-content: space-around;
      gap: 20px;
      margin-bottom: 30px;
    }
    .summary-card {
      flex: 1;
      background: #f8fafc;
      border: 2px solid #e2e8f0;
      border-radius: 8px;
      padding: 20px;
      text-align: center;
    }
    .summary-card h3 {
      font-size: 1.3em;
      margin-bottom: 15px;
      color: #334155;
    }
    .summary-card .number {
      font-size: 3em;
      font-weight: bold;
      color: #1e40af;
    }
    .summary-card .unit {
      font-size: 1.2em;
      color: #64748b;
    }
    .remarks-section {
      background: #f8fafc;
      border: 2px solid #e2e8f0;
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 20px;
    }
    .remarks-section h3 {
      font-size: 1.3em;
      margin-bottom: 15px;
      color: #334155;
    }
    .remarks-section textarea {
      width: 100%;
      min-height: 150px;
      padding: 10px;
      border: 1px solid #cbd5e1;
      border-radius: 4px;
      font-size: 1.1em;
      resize: vertical;
    }
    .action-buttons {
      display: flex;
      gap: 10px;
      justify-content: center;
      margin-bottom: 30px;
    }
    .action-btn {
      background: #0e7490;
      color: white;
      border: none;
      padding: 12px 30px;
      font-size: 1.3em;
      border-radius: 4px;
      cursor: pointer;
    }
    .action-btn:hover {
      background: #155e75;
    }
    .action-btn.capture {
      background: #0e7490;
    }
    .action-btn.capture:hover {
      background: #155e75;
    }
    .action-btn.save {
      background: #f59e0b;
      color: white;
    }
    .action-btn.save:hover {
      background: #d97706;
    }
    .weekly-summary {
      background: #f8fafc;
      border: 2px solid #e2e8f0;
      border-radius: 8px;
      padding: 20px;
      margin-top: 20px;
    }
    .weekly-summary h3 {
      font-size: 1.3em;
      margin-bottom: 15px;
      color: #334155;
    }
    .weekly-table {
      width: 100%;
      border-collapse: collapse;
      background: white;
    }
    .weekly-table th,
    .weekly-table td {
      border: 1px solid #e2e8f0;
      padding: 12px;
      text-align: center;
    }
    .weekly-table th {
      background: #1e40af;
      color: white;
      font-weight: bold;
    }
    .weekly-table tbody tr th {
      background: #1e40af;
      color: white;
      font-weight: bold;
      min-width: 60px;
    }
    .weekly-table tbody td.today,
    .weekly-table tbody th.today {
      background: #fef3c7;
      font-weight: bold;
    }
    .weekly-table tbody tr:first-child th.today {
      background: #f59e0b;
      color: white;
    }
    @media print {
      .container, .print-table-wrapper, .print-table-wrapper table {
        display: block !important;
      }
      nav, aside, .sidebar, header, footer, .non-print, .print-btn, #excel-download-btn, label[for="report-date"], #report-date, h2, .action-buttons {
        display: none !important;
      }
      @page {
        size: A4 landscape;
        margin: 0;
      }
      body { margin: 0; padding: 0; }
      .container, .print-table-wrapper {
        max-width: 100vw !important;
        width: 100vw !important;
      }
      .print-table-wrapper { width: 100vw; max-width: 100vw; page-break-after: always; }
      table { width: 100% !important; font-size: 14pt; border-collapse: collapse !important; }
      th, td { border: 1px solid #333 !important; padding: 8px !important; }
      th { background: #1e40af !important; color: #fff !important; }
      input, button, label, nav, aside, .sidebar, header, footer, .non-print, [class*="sidebar"], [class*="side-bar"], h2 {
        display: none !important;
      }
      .print-table-wrapper table {
        width: 100% !important;
        table-layout: auto !important;
        overflow: visible !important;
      }
      .print-table-wrapper th, .print-table-wrapper td {
        white-space: normal !important;
        word-break: break-all !important;
        overflow: visible !important;
        height: 48px !important;
        line-height: 1.4 !important;
        vertical-align: middle !important;
      }
      .print-table-wrapper {
        overflow: visible !important;
      }
      td:nth-child(4), th:nth-child(4) {
        min-width: 120px !important;
        width: 150px !important;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>ì¼ì¼ ì…ì¶œê³  í˜„í™© ë¦¬í¬íŠ¸</h2>
    <label for="report-date">ë‚ ì§œ ì„ íƒ:</label>
    <input type="date" id="report-date" />
    <button id="excel-download-btn">ì—‘ì…€ ë‹¤ìš´ë¡œë“œ</button>
    <button class="print-btn">í”„ë¦°íŠ¸</button>
    
    <!-- ìš”ì•½ ëŒ€ì‹œë³´ë“œ -->
    <div class="summary-dashboard" id="summary-dashboard">
      <div class="summary-title">LHM Pesqueria Hub ì¼ì¼ ë¦¬í¬íŠ¸</div>
      <div class="summary-date" id="summary-date"></div>
      
      <div class="summary-cards">
        <div class="summary-card">
          <h3>ğŸ“¥ ì˜¤ëŠ˜ ì…ê³ </h3>
          <div class="number" id="today-in-count">0</div>
          <div class="unit">ëŒ€</div>
        </div>
        <div class="summary-card">
          <h3>ğŸ“¤ ì˜¤ëŠ˜ ì¶œê³ </h3>
          <div class="number" id="today-out-count">0</div>
          <div class="unit">ëŒ€</div>
        </div>
        <div class="summary-card">
          <h3>ğŸ“¦ ì¬ê³  í˜„í™©</h3>
          <div class="number" id="current-stock">0</div>
          <div class="unit">ëŒ€</div>
        </div>
      </div>
      
      <div class="remarks-section">
        <h3>ğŸ“ íŠ¹ì´ì‚¬í•­ ë° ë¹„ê³ </h3>
        <textarea id="remarks-input" placeholder="íŠ¹ì´ì‚¬í•­ì„ ì…ë ¥í•˜ì„¸ìš”..."></textarea>
      </div>
      
      <!-- ê¸ˆì£¼ ì¼ë³„ í˜„í™© -->
      <div class="weekly-summary">
        <h3>ğŸ“Š ê¸ˆì£¼ ì¼ë³„ í˜„í™©</h3>
        <table class="weekly-table">
          <tbody id="weekly-summary-body">
            <!-- ë°ì´í„°ëŠ” JSë¡œ ì±„ì›€ (ê°€ë¡œ ë°©í–¥) -->
          </tbody>
        </table>
      </div>
      
      <div class="action-buttons non-print" id="action-buttons">
        <button class="action-btn capture" id="capture-btn" onclick="window.captureSummary()">ğŸ“¸ ìº¡ì³í•˜ê¸°</button>
        <button class="action-btn save" id="save-remarks-btn" onclick="window.saveRemarks()">ğŸ’¾ ì €ì¥í•˜ê¸°</button>
      </div>
    </div>
    
    <hr style="margin: 40px 0; border: 2px solid #dee2e6;">
    
    <div class="print-table-wrapper" id="print-table-wrapper"></div>
  </div>
</body>
</html> 